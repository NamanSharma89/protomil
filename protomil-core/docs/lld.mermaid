sequenceDiagram
    participant U as User
    participant UI as Login UI
    participant AC as AuthController
    participant AS as AuthService
    participant C as Cognito
    participant DB as Database
    participant RS as RoleService
    participant JWT as JWTManager
    participant SM as SessionManager

    U->>UI: Enter credentials
    UI->>AC: POST /wireframes/login
    AC->>AS: authenticateUser(email, password)

    AS->>C: signIn(email, password)
    C-->>AS: Cognito tokens + user info

    AS->>DB: findByEmail(email)
    DB-->>AS: User entity with status

    alt User not ACTIVE
        AS-->>AC: BusinessException(status)
        AC-->>UI: Show appropriate message
    else User ACTIVE
        AS->>RS: getUserRoles(userId)
        RS->>DB: Query user roles
        DB-->>RS: Role list
        RS-->>AS: User roles

        AS->>JWT: generateToken(userClaims)
        JWT-->>AS: JWT token

        AS->>SM: createSession(userId, token)
        SM->>SessionCache: Store session metadata

        AS-->>AC: AuthenticationResponse
        AC->>AC: Set HttpOnly cookie
        AC-->>UI: Redirect to /wireframes/dashboard
    end